spring:
  datasource:
    url: jdbc:postgresql://postgresql:5432/camunda
    username: postgres
    password: password
    driver-class-name: org.postgresql.Driver
  
  # Spring Session configuration for distributed session management
  session:
    store-type: hazelcast
    hazelcast:
      map-name: "spring-session-sessions"
      flush-mode: on-save
      save-mode: on-set-attribute
    timeout: 30m
  servlet:
    session:
      cookie:
        name: "CAMUNDA_SESSION"
        secure: true
        http-only: true
        same-site: lax

camunda.bpm.admin-user:
  id: demo
  password: demo

hazelcast:
  enabled: true
  instance-name: camunda-hazelcast
  map:
    name: myMap
    backup-count: 1
    time-to-live-seconds: 3600
    # GC-optimized memory management
    max-size:
      policy: USED_HEAP_PERCENTAGE
      value: 60  # Limit heap usage to 60% for GC efficiency
    eviction:
      policy: LRU
      max-size-check-interval-seconds: 60
    # Memory format optimization for GC
    in-memory-format: BINARY  # Default, most GC-friendly
  
  # Session configuration
  session:
    map-name: "spring-session-sessions"
    max-inactive-interval-minutes: 30
    cookie-name: "CAMUNDA_SESSION"
    cookie-secure: true
    cookie-http-only: true
  
  # Distributed Transaction Configuration
  transaction:
    enabled: true
    timeout-seconds: 30
    type: TWO_PHASE  # Options: TWO_PHASE, ONE_PHASE
    isolation: READ_COMMITTED  # Options: READ_UNCOMMITTED, READ_COMMITTED, REPEATABLE_READ, SERIALIZABLE
    retry-count: 3
    enable-xa: false
    # Deadlock detection settings
    deadlock-detection:
      enabled: true
      timeout-seconds: 10
      retry-backoff-multiplier: 1.5
      max-retry-delay-seconds: 5
    # Transaction monitoring and metrics
    monitoring:
      enabled: true
      log-transaction-details: false
      track-performance-metrics: true
  # Network optimization for reduced GC pressure
  network:
    port-auto-increment: true
    port-count: 100
    join:
      multicast:
        enabled: true
      tcp-ip:
        enabled: false
  # Management and monitoring
  management-center:
    enabled: false
  # Advanced memory management
  serialization:
    portable-version: 0
    use-native-byte-order: false
    byte-order: BIG_ENDIAN
    enable-compression: true
    enable-shared-object: true
    allow-unsafe: false

# Actuator endpoints configuration - separate port to avoid security conflicts
management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus,metrics
      base-path: /actuator
  server:
    port: 9000

# Health check configuration for Kubernetes probes
# Liveness and Readiness probe configuration
  endpoint:
    health:
      probes:
        enabled: true
        add-additional-paths: true
      show-details: always
      show-components: always
      livenessstate:
        enabled: true
      readinessstate:
        enabled: true
  prometheus:
    access: unrestricted